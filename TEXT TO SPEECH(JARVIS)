import speech_recognition as sr
import pyttsx3
import webbrowser
import os
import time

# 1. Initialize the Engine and Microphone
speaker = pyttsx3.init()
mic = sr.Recognizer()

# # Setting a faster voice rate (optional)
# speaker.setProperty('rate', 170) 

def speak(text):
    """Helper function to make speaking easier"""
    print(f"Jarvis: {text}")
    speaker.say(text)
    speaker.runAndWait()

def take_command():
    """Listens to the microphone and returns text"""
    try:
        with sr.Microphone() as source:
            print("\nListening...")
            mic.adjust_for_ambient_noise(source) # Removes background noise
            voice = mic.listen(source)
            command = mic.recognize_google(voice)
            return command.lower() # Convert to lowercase for easy matching
    except:
        return "none"

# 2. Main Execution Loop
if __name__ == "__main__":
    
    speak("Hello Rudra Pratap Singh Sir. I am online. What can I do for you?")

    while True:
        text = take_command()
        
        if text == "none":
            continue # If nothing heard, listen again

        print(f"User said: {text}")

        # LOGIC FOR YOUR COMMANDS 

        # 1. Open Chrome / Google
        if "chrome" in text or "open google" in text:
            speak("Opening Google Chrome...")
            # opens default browser (i.e., Chrome in my case)
            webbrowser.open("start www.google.com")

        # 2. Open Netflix
        elif "netflix" in text:
            speak("Opening Netflix for you, Sir.")
            webbrowser.open("www.netflix.com")

        # 3. Open Gemini
        elif "gemini" in text:
            speak("Opening Google Gemini AI...")
            webbrowser.open("start gemini.google.com")

        # 4. Turn on Bluetooth (Windows Trick)
        elif "bluetooth" in text:
            speak("Opening Bluetooth Settings...")
            # 'start ms-settings:bluetooth' is a Windows command to open Settings
            os.system("start ms-settings:bluetooth")


        # 5. Open Notepad (From your previous code)
        elif "notepad" in text:
            speak("Opening Notepad...")
            os.system("start notepad")

        # 6. Stop the Program
        elif "exit" in text or "stop" in text or "bye" in text:
            speak("Goodbye Rudra Sir. Have a nice day, See you again!")
            break
